<style>
:host {
    contain: content;
    display: inline-block;
}

:host cloudouble-element-icon {
    vertical-align: middle;
    margin-right: 0.2em;
}
</style>
<template>
    <span><slot></slot></span>
</template>
<script>
    /* global */
    class Symbol extends window.Cloudouble.Element.elements.Base {

        constructor() {
            super()
            this.name = this.hasAttribute('name') ? this.getAttribute('name') : ''
        }

        static get observedAttributes() {
            return (super.observedAttributes || []).concat('icon', 'name')
        }

        name($this, value) {
            return (value ? value : $this.innerText).replace('[^a-zA-Z0-9\-]+', '-').toLowerCase()
        }

        icon($this, value) {
            var iconNode
            var imgNode
            if (value && typeof value === 'string') {
                iconNode = $this.shadowRoot.querySelector('cloudouble-element-icon')
                if (!iconNode) {
                    iconNode = document.createElement('cloudouble-element-icon')
                    $this.shadowRoot.prepend(iconNode)
                }
                if ((value.slice(0,8) == 'https:\/\/') || (value.slice(0,5) == 'data:')) {
                    $this.setAttribute('style', `background-image: url(${value}); background-size: cover; border-radius: 100%;`)
                    iconNode.innerHTML = ''
                } else {
                    iconNode.innerHTML = value
                }
                return value
            } else {
                iconNode = $this.shadowRoot.querySelector('cloudouble-element-icon')
                if (iconNode) {
                    iconNode.remove()
                }
            }
        }

    }
</script>
